<!DOCTYPEHTML>
<html>

<head>
  <meta charset="utf-8" />
  <title>Gamedev Canvas Workshop</title>
  <style>
    * {
      padding: 0;
      margin: 0;
    }
    body{
      background: black;
    }
    canvas {
      background: #eee;
      display: block;
      margin: 0 auto;
    }
    .modal{
    	position: absolute;
    	left: 42%;
    	top: 100px;
    	height: 200px;
    	width: 200px;
    	background: white;
    	display: flex;
    	align-items: center;
    	flex-direction: column;
    	justify-content: space-evenly;
    }
    button{
    	width: 80px;
    }
  </style>
</head>

<body>
  <div class="container">
    	 <div id="modal" class="modal">
		<div class="modal-header">
        	<h2>Почати гру?</h2>
    	</div>
    	<div class="modal-footer">
        	<button id="closeModal">Так</button>
    	</div>
	</div>
	<div id="endmodal" class="modal">
		<div class="endmodal-header">
        	<h2 id="score"></h2>
    	</div>
    	<div class="endmodal-footer">
        	<button id="closeEndModal">Ще раз</button>
    	</div>
	</div>
  <canvas id="gameCanvas" width="500" height="400"></canvas>
  </div>
</body>
  <script>
    let canvas = document.getElementById("gameCanvas");
    let ctx = canvas.getContext("2d");
    document.getElementById('closeModal').addEventListener('click', function() {
		document.getElementById('modal').style.display = 'none';
		game=true;
	});
	document.getElementById('closeEndModal').addEventListener('click', function() {
		let enemy = { x: 300, y: 200, size: 30, speed: 2 };
		let player = { x: 50, y: 50, size: 30, speed: 5 };
	});
	document.getElementById('endmodal').style.display = 'none';
	let game = false;
    // --- 1. Гравець (квадрат)
    let player = { x: 50, y: 50, size: 30, speed: 5 };

    // --- 2. Монета
    let coin = { x: 200, y: 150, size: 15 };

    // --- 3. Противник
    let enemy = { x: 300, y: 200, size: 30, speed: 2 };

    let score = 0;
    // --- Слухаємо клавіші
    let keys = {};
    document.addEventListener("keydown", e => keys[e.key] = true);
    document.addEventListener("keyup", e => keys[e.key] = false);

    function update() {
      if (game==true) {
	      if (keys["ArrowUp"]) player.y -= player.speed;
	      if (keys["ArrowDown"]) player.y += player.speed;
	      if (keys["ArrowLeft"]) player.x -= player.speed;
	      if (keys["ArrowRight"]) player.x += player.speed;

	      // Рух ворога (до гравця)
	      if (enemy.x < player.x) enemy.x += enemy.speed;
	      if (enemy.x > player.x) enemy.x -= enemy.speed;
	      if (enemy.y < player.y) enemy.y += enemy.speed;
	      if (enemy.y > player.y) enemy.y -= enemy.speed;
	  }
      // Перевірка зіткнення з монетою
      if (Math.abs(player.x - coin.x) < player.size &&
          Math.abs(player.y - coin.y) < player.size) {
        score++;
        // нова монета у випадковому місці
        coin.x = Math.random() * (canvas.width - 20);
        coin.y = Math.random() * (canvas.height - 20);
      }

      // Перевірка зіткнення з ворогом
      if (Math.abs(player.x - enemy.x) < player.size &&
          Math.abs(player.y - enemy.y) < player.size) {
      	document.getElementById('endmodal').style.display = 'flex';
		game=false;
		document.getElementById('score').textContent = 'Ваш рахунок: ' + score;
      }
    }

    function draw() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);

      // Гравець
      ctx.fillStyle = "red";
      ctx.fillRect(player.x, player.y, player.size, player.size);

      // Монета
      ctx.fillStyle = "gold";
      ctx.beginPath();
      ctx.arc(coin.x, coin.y, coin.size, 0, Math.PI * 2);
      ctx.fill();

      // Противник
      ctx.fillStyle = "blue";
      ctx.fillRect(enemy.x, enemy.y, enemy.size, enemy.size);

      // Рахунок
      ctx.fillStyle = "black";
      ctx.font = "20px Arial";
      ctx.fillText("Очки: " + score, 10, 20);
    }
    function gameLoop() {
      update();
      draw();
      requestAnimationFrame(gameLoop);
    }

    gameLoop();
  </script>
</body>
</html>
